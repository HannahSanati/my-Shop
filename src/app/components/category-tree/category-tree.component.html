<!-- <div class="tree-container">
  <p-tree [value]="categories()" (onNodeSelect)="selectNode($event)" selectionMode="single">
    <ng-template let-node pTemplate="default">
      <div class="node-content">
        <span>{{ node.label }}</span>
        <div class="node-actions">
          <button pButton type="button" icon="pi pi-pencil" class="edit-btn" (click)="selectNode({ node })"></button>
          <button pButton type="button" icon="pi pi-trash" class="p-button-danger delete-btn"
            (click)="deleteCategory(+node.key)"></button>
        </div>
      </div>
    </ng-template>
  </p-tree>
</div> -->

<!-- <div class="tree-container">
  <p-tree [value]="categories()" (onNodeSelect)="selectNode($event)" selectionMode="single">
    <ng-template let-node pTemplate="default">
      <div class="node-content">
        <span>{{ node.label }}</span>
        <div class="node-actions">
          <button pButton type="button" icon="pi pi-pencil" class="edit-btn" (click)="selectNode({ node })"></button>
          <button pButton type="button" icon="pi pi-trash" class="p-button-danger delete-btn"
            (click)="deleteCategory(+node.key)"></button>
        </div>
      </div>
    </ng-template>
  </p-tree>
</div> -->



<div class="tree-container">
  <p-tree [value]="categories()" (onNodeSelect)="selectNode($event)" selectionMode="single">
    <ng-template let-node pTemplate="default">
      <div class="node-content">
        <span>{{ node.label }}</span>
        <div class="node-actions">
          <button pButton type="button" icon="pi pi-list" class="show-attributes-btn" (click)="showAttributesDialog(node)" title="نمایش ویژگی‌ها"></button>
          <button pButton type="button" icon="pi pi-pencil" class="edit-btn" (click)="selectNode({ node })" title="ویرایش دسته‌بندی"></button>
          <button pButton type="button" icon="pi pi-trash" class="p-button-danger delete-btn" (click)="deleteCategory(node.data.id)" title="حذف دسته‌بندی"></button>
        </div>
      </div>
    </ng-template>
  </p-tree>
</div>

<p-dialog
  header="ویژگی‌های {{ selectedNode()?.label }}"
  [(visible)]="showDialog"
  [modal]="true"
  [style]="{ width: '30rem' }"
  [draggable]="false"
  [resizable]="false"
  styleClass="attributes-dialog"
>
  <div *ngIf="selectedNode()?.data.attributes?.length; else noAttributes">
    <div *ngFor="let attr of selectedNode()?.data.attributes" class="attribute-item">
      {{ attr.attributeName }} ({{ attr.attributeType }}) 
      {{ attr.inherited ? '(ارث‌بری‌شده)' : '' }} 
      {{ attr.required ? '(اجباری)' : '' }}
    </div>
  </div>
  <ng-template #noAttributes>
    <div class="no-attributes">هیچ ویژگی‌ای وجود ندارد</div>
  </ng-template>
</p-dialog>
